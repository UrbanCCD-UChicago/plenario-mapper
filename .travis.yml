language:
- node_js
node_js:
- '6'
sudo: required
cache: pip
env:
  global:
  # AWS credentials
  - secure: h+u2fepdQV0B6SX/9fzlikdgNlaNpOJJDw5OXS8t0ab+gXu3atzleRAJBMSGEp7+DIjNUjvTMxwTk52qnihP0KsmTEYg/tH0Ka/zXpb+VDn4fD8CQfkGQR4Xd/lA7u4NxrcofC93mzsaMYrSTpceYOVQas2XoK25/Tlda87wbZ0nlaykOYzGBIehDuPndRRTSniM5u0vY3FWLP6sdUC1W/LKvg0T5hXdLN6lFQaYybb5mC1PxYkLhYGeX3zWaktHrrNwHo2tcIn+r6VKa2vG19tb7POsNsLT8K+0CFFxKZSpkDr3jkL8bTAo3DQ27htLqAOL9J4IV4xxUrZ+0tnKbeDeAsinVAVh8+1RqfrgsKLkPcC5Pn9kAPBS5AbfjafAH/0fXLTRwjLl78O7vPVZLmSbGxPfml1uzpdbvIPk+5rsRcYFZjscxkH/lmb65ly5OW6BuWtjbNraTPsYA8iBCuSHTOfWYHbLJG5edI+VlWpZCetTLhM3BXjRLE6VeyEaE9fsRZGUM5aiZ//XRCtp1HZi8G95QC1DloTfAmFzcFafTQSe+07BQYnZByJynv3AJ5EDtgmFt+Llf5r2MINFJJ0v2/OzjxQlwaMqzPo3gxzzEVIwBukyVjdcnuIv5wl/EEP64CS/FDIbLJhWSYQ+wr7W2CkDUWwn4Uhc6E8FdPk=
  - secure: sChHMVvsG5yIVBCy5huiKyK14ujZKA6zrRmvprdlfbSZBKHQXLEbLbmrm34A5RC2qjXA4yR/PDIE5YouY9eXOQ/w+7HX8AitB/cfXaFHjdmFrS2vEACwOqODhRaciEvmzVBzqW4UxHKsxe0dpinzycn2GQE9prX0k8CukioPOVmkQB1eYYi2+J8nfT1xO85w9DuIzTc5v9poKT2IMN0B4D9O/OFlBE2WxPIwfSBCpbiMHJZFnL57E7Mb9y9i8/bi5YuwWQqEkNx2mdintY0mYkEn1icPWei+Bj1RV6LiTgqRJ3skRQ10LzPS687cfso3ttHRxEwDqS82uwdsLhnzman0VMbyI0lF+2eDJgqHYijQNzN30ZwdFhVk5tQFbiu5WoUM/nLd+agm9MzbNx/uaJ7ud8CUj+jwR29BzjXW+IyvBiYCnVYdq+5thIVDzil4r0NTWFl9JeyCRZN+Lb5BhY0PBFmjhuosVXrf/uWfETB1WE40pr8Ccp5PjJdZKjGwMVh8wfJ4DEd+KIM+rSGs6XZ6m0Lh2e6kuOasK4fvhADq/Wx7voAarPnwdrSydpkUv+wJuPOlBINhOcv2f4a88ctvcb86Y7YKCMNGuZj5nT4k3FEUeUl9VWZjyqkHWkXLcg8/KYY7r2ZUCuPF0E01uOycKhYtzyaEhAftbIVBMiU=
  - AWS_DEFAULT_REGION=us-east-1
  # postgres test database credentials
  - DB_NAME=sensor_test
  # DB_USER
  - secure: Tw/pRtzJfbc5KuA8U/x3ErANc/WxRiwjP9lszlxFiwUUkbb+fnZV+hQjJg3C7IEFEKYNRXQy+drOcW42UrurcM+nrYyjnY4iZ6oFBGEGtHxNbiXnr8B0C+NdFMMqQ/MLx8cvBawq0/208kcO/O0UpPsUbOgIDZPeepXDR4+vWSPpE8nWx7SG6eLDg8y6COOvP0sXxpzTiYD7k8pYFxEctR9IQXiNfkOfWDHzAGuuHe04hThQAA8CYj65R3BAQfH7iwvzLYhSw5jRhCBjLNQpabKFE2ObagatjcYDomTYRKmvBLmVa9UoPChqf2GxlgZ4taBlgsAW6SAVQBJN5INUCSva3kgM0parudqJrZsEKJQkm+6TfXnbGpe6yKjXgjJXJBbN7vx0oh2k658x7dg8na0UN4N1BjiNaEGjm20JYNRK9jEWneoHydpHKJApapkLXa8Ethjfc+777YHzjr256ahGOvOAVkVcA0t9uXPPWN3bcGeL0NJPpBx4rW40ZnfaRoYwfCU5A3MuZ668Virwb5kLdc2fGp57xS3HtVgY3r/Y0dCerOZnvJ+ORbUcik7jaiGZTFM5EJix9ZHTfUg4eYsWPpLajYrnTLESE/5uYy4j0+I/c8JTgCtcOAsAG3xf3E2Sh7b23C+ZbQCl0QHMEDJ/GCSafRPpBXZxepiTrW0=
  # DB_PASSWORD
  - secure: f4ry8BqoqpIua4MzGXEnQLG7InCSblwc3MmVD0ecSWrqOvs+18Ui5zhVcWOOw1mndL8bDhaVxFuUNf+PIl/CHmo4mGK2ckkxUoWds9dpvVHvaGoAVAw4zI7vQQl3mQqT3NUc1ee2r3VtIwJdpJ1L2yiuGXHlPEbYbi2YHS22OdQyvWf94Fbv5X9GFhbTqQjXA4H9DrFPOhM/lILJyPXoN4nTZ0ysvCoGKSukdJ2L0mB0lx7fkuABTMtgbjqTnnCsK6tOmuTL+xt7V22QLgkhhNVdItmhnuL+kyfUvvXUcE3GRDGkBwyWUPwWQyCE2naF0Z7qP8XBSe5lryB4G9TSNByZb1oMunXz7yTX6OPdfx9wP06HRLsb7B0VXc0bXYhIJJMOe5uoeYBMNsL3lGcs4XNouUlc6XplIydJzqXmk6wNjvXOak4BhSk1TIVgorPnHb/J6SJZdy9PswPrgA3Jap8ShhEA4d+62OXGOO/xg6Uo6+uZBhMRbG30XhHmCo6NLLnyCgqoyyT3qUozUEz0d3XElZVpDIPGix3JxXR+XCSDw+Ndf4XujliMLo64RTF6CWEsIKa+Kctfs//4QUiuzbAalegwsuiiahMwXb6K4dLUovVHXOVGo9QQ3nSn+PVoGYuz2tm5HbM0BpDNbd7N7p7in/r/mm5o1aS7I78B89M=
  # DB_HOST
  - secure: VrizXN7zanbZ8UyEz7cqYBLshLtaMrkgo7mpGuht3KWYks87HPHgz6t7jAZ3NIWE2ALy5czBf9G2O3ZL2JGs56FZSzfVaVVWmIe5sCNFz3Q6W9nlNfBv3M8gG7qQ1xXDhQessi5mdMG9zFoG3IF7cyPY0g3CVu8b5Le6nec6op+mWvX/q8qctjj9JDcM+QvRvm0wMnDmqcGjN/f1ZgZ9ZuoP7k8Vwser/aaMrKZhlSJKSQK/z1yUzWz1wtm5tV/0y6tPadTGO8CCJ+Ll/kHQpW2+elsTnUknvqzFNAWOl/kx6Z6Dt34Vl49j1JJTLhsG/9FqfFv6R+5EgL5fS5vWEl97n6B057iENIMTYvqZ6J+D8hJJ1vHchlFtMdW/02XF538ed7krRl0jAT1R5YFjbO3XBU3pLzMV6Q9qUa/XgtSnPYSghmY/aGL4yvq1qsbmMSkMtgug5+NUsKPUvuEtwR9gnJwf06wEIfgFUNnaz+R26cinG663Sz/NiGLkYbYy8yK8Edyg/a+8Y0H21QaMYY6gRIuxZHVeAC3dmHRz0kU5Yx7DR0APB6iNIv2ZORQnmiqMwyxEYnjDJoI81MF2ReoSY0QX/gMm7PnyTwW8NjM3ycigB2lf5d5kSWV9rog2wHr5PX9ad3h3Q7qEPBMdxzOy1RVAZZ3O+8EGnOYfK6A=
  # DB_PORT
  - secure: JJ5tQVrahTKWcQQ70uCw6/4rIpkcfqPDZ5WedDwSbdejoAqZQhj9htRPlpa2Y0haaLVflcZKcalvyu+OVlJofxj/JqL8I2LZJpKbq639RvEDo51LEIleH/sp1EELE8IxGBYIZQIr1yuBhXjcmM4F/GoRlZxuJFZfcscbO4KvF1NSkJQjcOwEsMAPy1NGKgBNyH+PF2D5hmFxN7nkAXZMF4TgM3yS4cJqQYM0W/Q7H8KmIDVYUUFaURZC4yn1iZi6rAoGibvE6EcKK4OzHtED9SnkVEul5PBfWSOsQSQ5wkBFU7gbGsy4GH4MGcX8Kk5fCj2OmVLSf1+16SPgQVzZLs8W9OSNwZe12u5eaJnVojgVEEaCp7lHn7vCvEpXals28ohLFoFTr+u5ooTD1FaMp0vLPFzrHFjlT9JELmO5XwbQ+7YSioyKXNHyg8X18zkCC3Vfn6UECvHfr1IQcWP8SgxtcDv6BYsKryBM9e9z1bqhseDcBENEczTRdpKPSZdbnMFbn0vlTS74ZYtEQ7NfhBzJAzWxBeTKmm4DOK88n4gxeTc+gVCREIwA3DDNyhZlXteGi0x6nUifb05PrOgW4W+i5lhQHSF84iOWuzYuTNHkJktAkwMy+dEH/qltadrGr8G0M1yZGJF5dGylsahxkeg2Qx7eAHZ32kd4ssWdho8=
  # redshift test database credentials
  - RS_NAME=sensor_test
  # RS_USER
  - secure: irTsPp6yceZqH+mJP5Y6982lfLKfv5CVNAfheawqROlFuLuOHST5Ry5Njsko4ctmQtHt/LPFkOhTIrNty5n3K6bb4Oz3bfRbbZkLua2mjj2m/H43VtDxcRBpT7cLYxqaO6RaUto14bym/V7tYyaF8lnsKq5GMEtZmC7zvuq4HmLJZ/wr+tFkp/kjFdPdLon9M4/dwxI5dq74rdQRcWd1xu5knx+/3tdBjg6pDCKeJszr+buBLPI9zqnEINr351vll+T+/pK5IAwER2BYNKUURK0dPV9vXIFGYIatvrZ/OmLjISjaTfiTXIkEC+yKiCegyACZcIEtJElWKN8rUu7QMcoH2YnGdkcC7FKCmckMCftkpyhSyeRLSM7TJJQQN2oulMyjB3cEWtk9zIYTfsnYY2jLSMaLMd+GMizOKwIEGkSFZPMvw41k/t5VqFUyH33HSynWh5LkexL8jJH3u0RtjeJE4ocJOacfgG/5Lb3wzbdiPeCHiwMFgaSgKeo7NsHiVVJGJWhltiw64xh+oUAZN5cqiwBbaz8Ryvu7lOhawTTcQd1PoHJaU4KVvP1CHQdyNAb0nHQlihgBoVLs1rZiKEnkb1QG1WBPII7AiYHbAGjH/HexrmuoMleSuVhGFc0RPIEvxIftXN9NUS0aZWXWQOJNlQxui1JnqYCFCdEBreY=
  # RS_PASSWORD
  - secure: iLWaE/uenzE2x5wfbV+y/KV+UNF6sj2pBLd4zoUvJx24j4o1roGu2ElIz5ZhWConuefKsYx32MOZyqKbFIld/OHnQE4Va22RPAmmPZGl7VK3mBdHdC7bsXk5MWwwHHTb9P1sXfv78NQctvg5OE2wY7Q+cFu5XQqW8nTlUr0pj79Af1JdmGyB75DqdwXTOwVjv75o65c4ibbpMbkHAC6FtCIElqqWywYyjMbzdPGxLssbF4et73YNXjSFBDuv+xNp3uQLouxUCiBlw5xmMdZf5TCEt3ypKAzWw2LHcUmQ82wRg0a8vlUQCvRd8FpiIlL5f3yLTG1e26A6RgEp8QURiCbGzTEp4CerU9U1qqFg2Sq/zJPlBAyZT4ZaRAPt/bDIMOkkKBlUwTF8z0M9quMMbLjIPWE+i1ECUXF8aICGgrE5316nvLzAxvJr5MlztoLPkpkJkUyM5Fw+v8m8iHVN1P2N75xg+Nu7mb1Rak+45p39VGBDYQQzP0Y2L/qZZyYBTAvNXWKO8esS0h5YTAIaQcp1/uMLC+gxfTdeymKHP7qPqSk2q9CyBxpwrk/ziK+72qwoIDHbCqPEYyJdONh5ywVoXUC8KiSi57fuS+o/DlsrtFTtudjoHte5+//j1gO5+DX+mxsRTsgIp9CkLhDAwGLP3vc789jYHt8jINjg3co=
  # RS_HOST
  - secure: Mc+3Qf89Lj+wtMxhRrCbw6XZI02v3zDjg8PVREhYJ+3An1KVNEFicW/1nzMBn6jDF6kCuOSOVc85pzwsY8yet8cQdN7+LiBPskhok+wvPBEH13yv5GSwkBMKkNq5uJo/oDxMAOFNULBoAJn6Sqr0zLkucXMxBAxZNnZaOCTOkmtAGotPGl520UBsCnF7qURUbZtKHWj1O1IOPdiHW8SPC2f4645vBFl2PzzoCj33zyzCEbndavu8QJeCPLmZSTSIfO6f5h4778U0Vi7rD1dL5YYpKE+V5rh6eI1LPbzJ9bfmTrpdGqfAVr6girF4eQLATkJh48azZJFsPrMaoFw2ttqdoMXu1gi+Xd+laQww6lQ4WnLyWM3e6KTc+XQ0FnOaD2TJulYyos+T6LhnUcAcX8/I+u0rgoQkOLWz6eUEQv4YytwjNtCAiZLTMcTdstuzRDMX1fes045ykxb/qXXT/EGulFsFaD2GzD4c8DAKSfdrRGtNVih89EtlWleH/ap89+nnZVuwCMdmr4/TJuzA6rw/uk6eIH8hYq0NrFO/L2EFZSAoif3inR0rB33krM8rqNjQ+U4/hfFwK2spIOHQrEzuPmDiJHpqhC0E10/ro2Mp5nfANC+2btuD2UVFcaD4pmaregaUZx7SRNbZ5JEGOfmT7kws4ToBslr/aBujc/g=
  # RS_PORT
  - secure: c718z1aHk+eqKxf4dUM3q35b/KVrw+qd3c6RI4IbceFxbk6MddzYe9zEBO0+SDTcfr5Km93XtOLxDqVfgpnDi9/vdXKgVZdcCI1fMuzprSdu8+j/8Mt1D9ZcOn3po/7i1RnSgifDND7ktrifFqxDNykHtPzIU7hOLEYVJRGS7zjiYJRGxL+HCSkvKFKesiWTwHYQBmwwvE4xIsw87Jycthqd4pRCgWYogD9e212o36SpLbGp89hgf+dgVmEuaSbYELO9S3fNv8ZXv5Q8ZafXd2CRqsf9Xp6TA3cCuzO9N7Lw4awwChScJqXEG87eIdZwxk5n6rh0rOYDlR19cjA4t5Bn6/TlLSS+Fo1IU6QIn9NvsljPkh/NwVeZk/xDphGFJD/OSmIKKJLeuYJJ1X6NgJUFF+BvskWLAbnvhK7Vt0SV2U54JSB3i86ahGauNqJN54PbozdjJcjI527VMwGK92QFV3iI8WxCpNXUSYwvfR29o1v7pAy+rQ9+8FTJfDfEDaJmWOuXp9ad2rlspLh0/w/88eeBMkMDWgRD3l1f4OHDOHPmXVpW+OovAgdc/ay57rWOM8iHXHfikJsAUC6wFgw2tMyuY3sROL0wHzDRV8Ga4YRfJgjajgQ9y1zQokSOuCNBqQi8a2cCO2/L6aGNBJS6rP9Gj9mdmw4+aPoRF5g=
install:
- sudo pip install awscli
- aws kinesis create-stream --stream-name TestStream --shard-count 1
- npm install
before_script:
- sed -i -e 's/streamName = ObservationStream/streamName = TestStream/g' app/consumer/sample.properties
- sed -i -e 's/applicationName = kinesis_consumer/applicationName = kinesis_consumer_test/g' app/consumer/sample.properties
- node configure_tests.js setup
- npm test
- node configure_tests.js teardown
script:
- sed -i -e 's/streamName = TestStream/streamName = ObservationStream/g' app/consumer/sample.properties
- sed -i -e 's/applicationName = kinesis_consumer_test/ applicationName = kinesis_consumer/g' app/consumer/sample.properties
- aws kinesis delete-stream --stream-name TestStream
deploy:
  provider: elasticbeanstalk
  access_key_id: AKIAIK5AQSFJXZVPPUOQ
  secret_access_key:
  - secure: o1W5pqfU70J460mQeKymGd9ADrvv0thPFSsKnnzEtVSl+dADIFExKplGCy0ciqMbKGJmgS+SfncbWV1FdEvCzjmi9vfx8THue7PooDKMxE4uXvlhq+g1BQKfUIjGmrnusj/Cmt50sTsFisTSVQRapkgyEWYb/0Vcu+DIPVj7OaW74MGNc5jHRPmG4VG9uidz6GmwSSOgkGgnt7a6nHFa0FJ1XOA4fVZk51TDhbp1r2YkXN0iKUwfaJcvf0Wh8iwqUsTZB6SV+Wly64FWZAaerFBn+xwozE9iYx76rSFHgcBysQIrqFpI6FtoLlkaZfP0FSe1UuMIkckvgIH0dBdHfm58Dn4bHDmRkq+pHeXx3c5sDeoiLyz7gYS7E3mF+70Eb1ql+XnyNV94q/mF7C49DBEvsLR0Uq8t8pQ4AoCKNQO6Aax/bFL3tYqkm3l8kCA2I9tDLVUI71QA9ff4olk6d3bQPozoujGjjHh/3nrBLQtX7bTkSvzSlyptlOYCxqnrPHSHTcljns10epbHPlO8POdNlAPqjHuHcqytlz+zogr0MXSuI+jc4XOV2Tv001Sslwc/c/0q4Njctc9UDCy9l+0Vvu8h1LepFlmXHjCHyXgzHrvDMnaitpROODHDUwM6W/jvZ3LsCoQtk2AxrMH6OU8ctE7lKY9zZSVBW82xm7A=
  region: us-east-1
  app: Kinesis-Consumer
  env: kinesisConsumer-env2
  bucket_name: elasticbeanstalk-us-east-1-031052761859
  on:
    repo: UrbanCCD-UChicago/plenario-mapper
notifications:
  slack:
    rooms:
      secure: TFyRsj9towye1rfCrqu+s/aBSZQ5N/+NtNvamLQ8aa8QvSA4nAunTgQI8sHTnIXMWSHEJhYtlGwoYfq8agobyX0O7jQw1cwszPmkewYMPnhzD5k4oCucCbZVOcFDtMPC/BRCnBokCxEok0/R7jcLI584cfLB2YIp83Vks1ctcw5rMaYXp7KPjA/WEUX1ml7kv8RRlF0+p2+AShMJeXHHzTOg1vGqIuJrCKl/Uia+3UnAU99eDF1b3UZQL7zO3XSExMa6oujd0uNgEUSBzk0DJa4E7Gk7ipYJUyCqyXc9OFgXRvFbocFgRPXSEus/LuBZA5Z8LjTxb1U1k/zgZvkHETdJpykk4Z91dqIlhlRMds43BYBS7EAuipBZpLZz57Q/7tiBMpXmuVVbxmUuLHqLA+msnkXZ57qY8AwTSO3WsjEARzPhzz5BhqXGDYQZBlsGCeszzc8g30JoHMn10MiWqAqLzYX+Qj3s0QfSIaL6+en9jx98ZfURJ0q9Ku6wNb6YcdLCLvtoDtUl1oe2DhUoQlS+euWgIfdeq1tcpmePXabe0l2wjRgSep6M4H/iFvtPiqTky5ktMaiyDeaR88bixvy/AmAnhvHT51symrSCLhsgdWfvil0vPlbqR5N/IsP2ShlA3AqpTNOgb5iehf488GXnYBuMRuUpCBD90EPMHgY=
